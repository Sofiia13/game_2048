var e,t,r;t=new((e=/*#__PURE__*/function(){var e;function t(e){(function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")})(this,t),console.log(e),this.isGameOver=!1,this.score=0,this.hasMovedOnce=!1}return e=[{key:"moveLeft",value:function(){var e=this;if(!this.isGameOver){var t=this.getState();return document.querySelector("tbody").querySelectorAll("tr").forEach(function(t){var r=Array.from(t.querySelectorAll("td"));e.processLine(r)}),this.afterMoveActions(t),this.score}}},{key:"moveRight",value:function(){var e=this;if(!this.isGameOver){var t=this.getState();return document.querySelector("tbody").querySelectorAll("tr").forEach(function(t){var r=Array.from(t.querySelectorAll("td"));r=r.reverse(),e.processLine(r)}),this.afterMoveActions(t),this.score}}},{key:"moveUp",value:function(){var e=this,t=function(t){var r=[];o.forEach(function(e){r.push(e.querySelectorAll("td")[t])}),e.processLine(r)};if(!this.isGameOver){for(var r=this.getState(),o=document.querySelector("tbody").querySelectorAll("tr"),s=o[0].querySelectorAll("td").length,n=0;n<s;n++)t(n);return this.afterMoveActions(r),this.score}}},{key:"moveDown",value:function(){var e=this,t=function(t){var r=[];o.forEach(function(e){r.push(e.querySelectorAll("td")[t])}),r.reverse(),e.processLine(r)};if(!this.isGameOver){for(var r=this.getState(),o=document.querySelector("tbody").querySelectorAll("tr"),s=o[0].querySelectorAll("td").length,n=0;n<s;n++)t(n);return this.afterMoveActions(r),this.score}}},{key:"getScore",value:function(){document.querySelector(".game-score").textContent=this.score}},{key:"getState",value:function(){var e=[];return document.querySelectorAll("tbody tr").forEach(function(t){var r=[];t.querySelectorAll("td").forEach(function(e){var t=parseInt(e.textContent.trim());r.push(isNaN(t)?0:t)}),e.push(r)}),e}},{key:"getStatus",value:function(){var e=this.getState(),t=e.some(function(e){return e.includes(0)}),r=e.some(function(e){return e.includes(2048)});return t||this.canMerge(e)?r?(this.isGameOver=!0,document.querySelector(".message-win").classList.remove("hidden"),"win"):"playing":(this.isGameOver=!0,document.querySelector(".message-lose").classList.remove("hidden"),"lose")}},{key:"start",value:function(){this.isGameOver=!1,document.querySelector(".message-start").classList.add("hidden");var e=0;this.getState().forEach(function(t){t.forEach(function(t){0!==t&&e++})});for(var t=0;t<2-e;t++)this.generateCube();this.getScore()}},{key:"restart",value:function(){this.isGameOver=!1,this.hasMovedOnce=!1;var e=document.querySelector(".button");e.classList.remove("restart"),e.classList.add("start"),e.textContent="Start",document.querySelector(".message-start").classList.remove("hidden"),document.querySelector(".message-lose").classList.add("hidden"),document.querySelector(".message-win").classList.add("hidden"),this.score=0,document.querySelectorAll("tbody tr").forEach(function(e){e.querySelectorAll("td").forEach(function(e){e.textContent="",e.classList.forEach(function(t){t.startsWith("field-cell--")&&e.classList.remove(t)})})}),this.getScore()}},{key:"extractValues",value:function(e){var t=[];return e.forEach(function(e){var r=e.textContent.trim();""!==r&&t.push(r)}),t}},{key:"updateCells",value:function(e,t){e.forEach(function(e,r){e.classList.forEach(function(t){t.startsWith("field-cell--")&&e.classList.remove(t)}),t[r]?(e.classList.add("field-cell--".concat(t[r])),e.textContent=t[r]):e.textContent=""})}},{key:"processLine",value:function(e){var t=this.extractValues(e);this.mergeCubes(t),this.updateCells(e,t)}},{key:"afterMoveActions",value:function(e){var t=this.getState();this.areStatesEqual(e,t)||(this.generateCube(),this.getStatus(),this.markFirstMove())}},{key:"mergeCubes",value:function(e){for(var t=0;t<e.length;t++)e[t]===e[t+1]&&(e[t]*=2,this.score+=e[t],e.splice(t+1,1));return e}},{key:"generateCube",value:function(){var e=document.querySelector("tbody").querySelectorAll("tr"),t=Math.floor(Math.random()*e.length),r=e[t].querySelectorAll("td"),o=Math.floor(Math.random()*r.length),s=r[o];if(""!==s.textContent.trim()){this.generateCube();return}var n=.9>Math.random()?2:4;s.classList.add("field-cell--".concat(n)),s.textContent=n}},{key:"canMerge",value:function(e){for(var t=0;t<4;t++)for(var r=0;r<4;r++){var o=e[t][r];if(r<3&&o===e[t][r+1]||t<3&&o===e[t+1][r])return!0}return!1}},{key:"areStatesEqual",value:function(e,t){for(var r=0;r<e.length;r++)for(var o=0;o<e[r].length;o++)if(e[r][o]!==t[r][o])return!1;return!0}},{key:"markFirstMove",value:function(){if(!this.hasMovedOnce){var e=document.querySelector(".button");e.classList.remove("start"),e.classList.add("restart"),e.textContent="Restart",this.hasMovedOnce=!0}}}],function(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}(t.prototype,e),t}())&&e.__esModule?e.default:e),(r=document.querySelector(".button")).addEventListener("click",function(){r.classList.contains("start")?t.start():r.classList.contains("restart")&&t.restart()}),document.addEventListener("keydown",function(e){switch(e.key){case"ArrowLeft":t.moveLeft(),t.getScore();break;case"ArrowRight":t.moveRight(),t.getScore();break;case"ArrowUp":t.moveUp(),t.getScore();break;case"ArrowDown":t.moveDown(),t.getScore()}});
//# sourceMappingURL=index.08f9bb90.js.map
